<!DOCTYPE html>
<html ng-app="coachDashBoard">

<head>
    <title>Progress Dashboard</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <script src="/js/angular.min.js"></script>
    <script src="/js/angular-filter.min.js"></script>
    <script src="/js/smart-table.min.js"></script>
    <script src="/js/angular-animate.js"></script>
    <script src="/js/angular-sanitize.js"></script>
    <script src="/js/ui-bootstrap-tpls-2.5.0.min.js"></script>
    <link rel="stylesheet" href="/pmodule/password_modal.css">
    <link rel="shortcut icon" href="/images/edu_favicon.png" type="image/x-icon">
    <script src="/js/coachDashboard/results.js"></script>
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="stylesheet" href="/css/results.css">
    <!-- jquery and bootstrap js-->
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
</head>

<body class="mainBackground" ng-app="edulutionPortal" ng-controller="MainCtrl">
    <!-- Navigation Bar -->
    <nav class="navbar navbar_background">
        <div class="container">
            <div class="navbar-header logos">
                <a class="navbar-brand logo" href="/">
                    <img class="img-responsive" src="images/edulution_logo_white.svg">
                </a>
            </div>
            <p class="title_header">Progress Dashboard</p>
            <div class="index_button">
                <button class="btn btn-button index_btn" ng-click="menu.refresh()">
                    <h4>Refresh</h4>
                </button>
            </div>
        </div>
    </nav>
    <script type="text/ng-template" id="navigation.html">
        <div class="container-fluid tabs">
            <ul class="nav nav-tabs">
              <li ng-class="{ active: menu.isSelected(0) }">
                <a href="#" ng-click="menu.selectTab(0)"><h3>Test Results</h3></a>
              </li>
              <li ng-class="{ active: menu.isSelected(1) }">
                <a href="#" onclick="window.open('https://stats1.edulution.org/coach_stats/','_self')" ng-click="menu.selectTab(1)"><h3>Activity</h3></a>
              </li>
            </ul>
          </div>
    </script>
    <!-- get results template -->
    <script type="text/ng-template" id="get_results.html">
        <div id="get_results_form">
            <form class="form-inline">
                <div class="form-group">
                    <input type="text" name="seluser" ng-model="selUser" class="form-control" placeholder="Coach ID e.g ZM_TY876">
                </div>
                    <button class="btn btn-primary btn-md" type="submit" ng-click="get_results()">Get Results</button>
            </form>
        </div>


        <div class="table-responsive row">
            <table st-table="selresults_placeholder" st-safe-src="selresults" class="table">
                <thead>
                    <tr>
                        <th id="responses_search">
                          <input st-search type="search" placeholder="Test name, Test Date..." class="form-control">
                        </th>
                        <th id="module_search">
                            <select st-search="module" class=" form-control module_select_dropdown">
                                <option value="" class="module_initial_value">Module</option>
                                <option ng-repeat="row in results | unique: 'module'" value="{{row.module}}">{{row.module | ucfirst}}</option>
                            </select>
                        </th>                        
                    </tr>
                    <tr>
                        <th st-ratio="25" st-sort="username">Username</th>
                        <th st-ratio="15" st-sort="first_name">First Name</th>
                        <th st-ratio="15" st-sort="last_name">Last Name</th>
                        <th st-ratio="15" st-sort="test_name">Test</th>
                        <th st-ratio="10" st-sort="score_pct">Score</th>
                        <th st-ratio="15" st-sort="test_date">Test Date</th>
                    </tr>
                </thead>
                
                    
                <tbody>
                    <tr ng-repeat="result in selresults_placeholder">
                        <td st-ratio="25">{{result.username}}</td>
                        <td st-ratio="15">{{result.first_name }}</td>
                        <td st-ratio="15">{{result.last_name}}</td>
                        <td st-ratio="15">{{result.test_name}}</td>
                        <!-- color the score percent cells using same color scheme from heat map -->
                        <td st-ratio="10" ng-style="result.score_pct <= 0 && {'background-color': '#D9D9D9'} ||
                                      result.score_pct <= .25 && {'background-color': '#FF412A'} ||
                                      result.score_pct <= .50 && {'background-color': '#EC9090'} ||
                                      result.score_pct <= .69 && {'background-color': '#F5C216'} ||
                                      result.score_pct <= .84 && {'background-color': '#99CC33'} ||
                                      result.score_pct <=  1 && {'background-color': '#00B050'}">
                                {{result.score_pct * 100 | number : 1}}%
                        </td>
                        <td st-ratio="15">{{result.test_date | date: 'mediumDate'}}</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="5" class="text-center">
                            <div st-pagination="" st-items-by-page="itemsByPage"></div>
                        </td>
                    </tr>
                </tfoot>
            </table>
            
        </div> <!-- table row -->
    </script>
    <span ng-init=init()></span>
    <navigation></navigation>
    <div class="container-fluid">
        <getresults ng-show="menu.isSelected(0)"></getresults>
    </div>
</body>

</html>